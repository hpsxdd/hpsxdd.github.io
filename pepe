<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Mi DÃ­a Emocional</title>
  <style>
    body {
      background-color: #1a1a1a;
      color: #f0f0f0;
      font-family: Arial, sans-serif;
      padding: 40px;
      max-width: 800px;
      margin: auto;
    }
    h1, h2 {
      text-align: center;
    }
    #racha {
      text-align: center;
      margin-bottom: 20px;
      font-size: 20px;
    }
    textarea {
      width: 100%;
      height: 150px;
      background: #2b2b2b;
      color: white;
      border: none;
      padding: 15px;
      font-size: 16px;
      resize: none;
    }
    button {
      margin-top: 20px;
      padding: 10px 20px;
      background: #ff3366;
      border: none;
      color: white;
      font-size: 16px;
      cursor: pointer;
      display: block;
      margin-left: auto;
      margin-right: auto;
      border-radius: 10px;
    }
    button:hover {
      background: #ff4d80;
    }
    .emocion {
      text-align: center;
      margin: 20px 0;
      font-size: 20px;
    }
    .emoji-bar {
      font-size: 40px;
      width: 80px;
      height: 80px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      background: conic-gradient(#ff3366 0%, #2b2b2b 0%);
      transition: background 1s linear;
      margin: 0 auto 10px;
    }
    .mensaje-final {
      margin-top: 30px;
      font-size: 18px;
      color: #bbb;
      text-align: center;
    }
  </style>
</head>
<body>
  <h1>Â¿CÃ³mo fue tu dÃ­a?</h1>
  <div id="racha">Racha actual: 0 dÃ­as seguidos</div>

  <textarea id="inputDia" placeholder="Escribe cÃ³mo fue tu dÃ­a..."></textarea>
  <button onclick="analizarDia()">Enviar</button>

  <div id="resultados" style="display:none;">
    <h2>Resultados emocionales:</h2>

    <div class="emocion">
      <div class="emoji-bar" id="felicidadBar">ðŸ˜Š</div>
      <p id="txtFelicidad"></p>
    </div>
    <div class="emocion">
      <div class="emoji-bar" id="depresionBar">ðŸ˜¥</div>
      <p id="txtDepresion"></p>
    </div>
    <div class="emocion">
      <div class="emoji-bar" id="vivirBar">ðŸ’ª</div>
      <p id="txtVivir"></p>
    </div>
    <div class="emocion">
      <div class="emoji-bar" id="morirBar">ðŸ’€</div>
      <p id="txtMorir"></p>
    </div>

    <div class="mensaje-final" id="mensajeFinal"></div>
  </div>

  <script>
    const mensajesOscuros = [
      "Felicidades, otro dÃ­a menos que aguantar.",
      "Vas bienâ€¦ directo a la tumba.",
      "La buena noticia: sigues vivo. La mala: sigues vivo.",
      "Un paso mÃ¡s cerca del descanso eterno.",
      "Â¿Otra vez tÃº? PensÃ© que ya habÃ­as terminado.",
      "La vida sigue... lamentablemente.",
      "Sobreviviste al dÃ­a. Pero no a ti mismo."
    ];

    function getFechaHoy() {
      const hoy = new Date();
      return hoy.toISOString().split('T')[0];
    }

    function cargarRacha() {
      const ultimaFecha = localStorage.getItem('ultimaEntrada');
      const hoy = getFechaHoy();
      let racha = parseInt(localStorage.getItem('racha') || '0');

      if (ultimaFecha) {
        const ultima = new Date(ultimaFecha);
        const ahora = new Date(hoy);
        const diferencia = (ahora - ultima) / (1000 * 60 * 60 * 24);

        if (Math.round(diferencia) === 1) {
          racha += 1;
        } else if (diferencia > 1) {
          racha = 0;
        }
      }

      localStorage.setItem('racha', racha);
      document.getElementById('racha').textContent = `Racha actual: ${racha} dÃ­a${racha === 1 ? '' : 's'} seguidos`;
    }

    function animarRelleno(elementId, porcentaje, color) {
      const el = document.getElementById(elementId);
      let progreso = 0;
      const intervalo = setInterval(() => {
        progreso++;
        el.style.background = `conic-gradient(${color} ${progreso}%, #2b2b2b ${progreso}%)`;
        if (progreso >= porcentaje) clearInterval(intervalo);
      }, 15);
    }

    function analizarDia() {
      const texto = document.getElementById('inputDia').value.trim();
      if (texto === "") {
        alert("Por favor escribe algo sobre tu dÃ­a.");
        return;
      }

      const ultimaFecha = localStorage.getItem('ultimaEntrada');
      const hoy = getFechaHoy();

      if (ultimaFecha !== hoy) {
        localStorage.setItem('ultimaEntrada', hoy);
        let racha = parseInt(localStorage.getItem('racha') || '0');
        if (!ultimaFecha) {
          racha = 1;
        } else {
          const diff = (new Date(hoy) - new Date(ultimaFecha)) / (1000 * 60 * 60 * 24);
          racha = Math.round(diff) === 1 ? racha + 1 : 1;
        }
        localStorage.setItem('racha', racha);
      }

      cargarRacha();

      const felicidad = Math.floor(Math.random() * 101);
      const depresion = Math.floor(Math.random() * (100 - felicidad));
      const ganasMorir = Math.floor(Math.random() * (100 - felicidad - depresion));
      const ganasVivir = 100 - (felicidad + depresion + ganasMorir);

      document.getElementById("txtFelicidad").textContent = `Felicidad: ${felicidad}%`;
      document.getElementById("txtDepresion").textContent = `DepresiÃ³n: ${depresion}%`;
      document.getElementById("txtMorir").textContent = `Ganas de morir: ${ganasMorir}%`;
      document.getElementById("txtVivir").textContent = `Ganas de vivir: ${ganasVivir}%`;

      animarRelleno("felicidadBar", felicidad, "#ffcc00");
      animarRelleno("depresionBar", depresion, "#3399ff");
      animarRelleno("morirBar", ganasMorir, "#ff3366");
      animarRelleno("vivirBar", ganasVivir, "#33cc66");

      const mensaje = mensajesOscuros[Math.floor(Math.random() * mensajesOscuros.length)];
      document.getElementById("mensajeFinal").textContent = mensaje;

      document.getElementById("resultados").style.display = "block";
    }

    cargarRacha();
  </script>
</body>
</html>
